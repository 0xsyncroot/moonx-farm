# =============================================================================
# üöÄ MoonX Farm Notification Hub - Production Environment Variables
# =============================================================================
# 
# File n√†y ch·ªâ ch·ª©a c√°c env variables TH·ª∞C S·ª∞ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong code
# ƒê√£ lo·∫°i b·ªè t·∫•t c·∫£ env kh√¥ng c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh confusion
# 
# =============================================================================

# =============================================================================
# üåç Core Application Configuration
# =============================================================================

# Environment type - Required for infrastructure packages
NODE_ENV=production

# Server configuration - Used in server.ts
PORT=3008                              # Server port number
HOST=0.0.0.0                           # Server host binding

# Logging configuration - Used by @moonx-farm/common logger
LOG_LEVEL=info                         # Log level: debug, info, warn, error
APP_NAME=moonx-notification-hub        # Service name for logs
LOG_ENABLE_CONSOLE=true                # Enable console logging
LOG_ENABLE_FILE=false                  # Enable file logging (optional)
LOG_DIR=logs                           # Log directory (if file logging enabled)
LOG_MAX_FILES=5                        # Max log files to keep
LOG_MAX_SIZE=10m                       # Max log file size
LOG_FORMAT=json                        # Log format: json or console

# =============================================================================
# üìä Database Configuration (PostgreSQL)
# =============================================================================
# Used by @moonx-farm/infrastructure DatabaseManager
# Supports URL-based config (recommended) or individual variables

# Option 1: Database URL (recommended for production)
DATABASE_URL=postgresql://postgres:your_password@localhost:5432/moonx_notifications

# Option 2: Individual variables (can override URL settings)
DB_HOST=localhost                      # Database host
DB_PORT=5432                           # Database port
DB_NAME=moonx_notifications            # Database name
DB_USER=postgres                       # Database username
DB_PASSWORD=your_secure_password       # Database password

# Connection settings
DB_SSL=true                            # Enable SSL connection
DB_MAX_CONNECTIONS=20                  # Max pool connections
DB_MIN_CONNECTIONS=2                   # Min pool connections
DB_IDLE_TIMEOUT=30000                  # Idle timeout (ms)
DB_CONNECTION_TIMEOUT=10000            # Connection timeout (ms)
DB_STATEMENT_TIMEOUT=60000             # Statement timeout (ms)
DB_QUERY_TIMEOUT=30000                 # Query timeout (ms)

# Reliability
DB_MAX_RETRIES=3                       # Max retry attempts
DB_RETRY_DELAY=1000                    # Retry delay (ms)
DB_APPLICATION_NAME=moonx-notification-hub  # App name in DB

# Monitoring
DB_ENABLE_METRICS=true                 # Enable DB metrics
DB_ENABLE_QUERY_LOGGING=false          # Enable query logging (debug only)

# =============================================================================
# üî¥ Redis Configuration (Caching & Queue)
# =============================================================================
# Used by @moonx-farm/infrastructure RedisManager
# Supports URL-based config (recommended) or individual variables

# Option 1: Redis URL (recommended for production)
REDIS_URL=redis://username:password@localhost:6379/0

# Option 2: Individual variables (can override URL settings)
REDIS_HOST=localhost                   # Redis host
REDIS_PORT=6379                        # Redis port
REDIS_PASSWORD=your_redis_password     # Redis password
REDIS_DB=0                             # Redis database number

# Connection settings
REDIS_KEY_PREFIX=moonx:hub:            # Key prefix for namespace
REDIS_FAMILY=4                         # IP family (4 or 6)
REDIS_CONNECT_TIMEOUT=10000            # Connection timeout (ms)
REDIS_COMMAND_TIMEOUT=5000             # Command timeout (ms)
REDIS_MAX_RETRIES=3                    # Max retry attempts
REDIS_RETRY_DELAY=100                  # Retry delay (ms)

# Features
REDIS_LAZY_CONNECT=true                # Lazy connection (recommended)
REDIS_ENABLE_METRICS=true              # Enable Redis metrics
REDIS_ENABLE_OFFLINE_QUEUE=true        # Enable offline queue

# =============================================================================
# üì® Kafka Configuration (Event Streaming)
# =============================================================================
# Used by @moonx-farm/infrastructure KafkaManager

# Connection - Required
KAFKA_BROKERS=kafka-1:9092,kafka-2:9092,kafka-3:9092  # Kafka broker list
KAFKA_CLIENT_ID=notification-hub-prod                   # Client identifier

# Authentication (optional)
KAFKA_SSL=false                        # Enable SSL
KAFKA_USERNAME=your_kafka_username     # SASL username (if using auth)
KAFKA_PASSWORD=your_kafka_password     # SASL password (if using auth)
KAFKA_SASL_MECHANISM=plain             # SASL mechanism

# Connection settings
KAFKA_CONNECTION_TIMEOUT=10000         # Connection timeout (ms)
KAFKA_REQUEST_TIMEOUT=30000            # Request timeout (ms)
KAFKA_MAX_CONNECTIONS=10               # Max connections
KAFKA_IDLE_TIMEOUT=300000              # Idle timeout (ms)

# Performance
KAFKA_COMPRESSION=gzip                 # Compression: gzip, snappy, lz4, zstd
KAFKA_LOG_LEVEL=info                   # Kafka log level
KAFKA_ENABLE_METRICS=true              # Enable Kafka metrics
KAFKA_TRANSACTION_TIMEOUT=30000        # Transaction timeout (ms)

# Retry configuration
KAFKA_RETRY_INITIAL_TIME=100           # Initial retry delay (ms)
KAFKA_RETRY_COUNT=8                    # Max retry attempts

# Schema Registry (optional)
KAFKA_SCHEMA_REGISTRY_URL=http://schema-registry:8081           # Schema registry URL
KAFKA_SCHEMA_REGISTRY_USERNAME=your_schema_registry_username    # Schema registry username
KAFKA_SCHEMA_REGISTRY_PASSWORD=your_schema_registry_password    # Schema registry password

# =============================================================================
# üìß Email Configuration (SendGrid)
# =============================================================================
# Used in server.ts EmailService initialization

# SendGrid API - Required for email notifications
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here    # SendGrid API key
SENDGRID_FROM_EMAIL=noreply@moonx.farm             # From email address
SENDGRID_FROM_NAME=MoonX Farm                      # From name

# SMTP Fallback (optional backup)
SMTP_HOST=smtp.gmail.com               # SMTP server host
SMTP_PORT=587                          # SMTP server port
SMTP_SECURE=true                       # Enable SMTP TLS
SMTP_USER=your_smtp_user@gmail.com     # SMTP username
SMTP_PASSWORD=your_smtp_password       # SMTP password

# Email defaults
EMAIL_FROM=MoonXFarm <noreply@moonx.farm>  # Default from address

# =============================================================================
# üì± Push Notification Configuration (Firebase FCM)
# =============================================================================
# Used in server.ts PushNotificationService initialization

# Firebase Service Account - Required for push notifications
FIREBASE_PROJECT_ID=your-firebase-project-id                     # Firebase project ID
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----"  # Firebase private key
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xyz@your-project.iam.gserviceaccount.com  # Firebase client email

# =============================================================================
# ü§ñ Telegram Bot Configuration (grammy framework)
# =============================================================================
# Used in deliveryService.ts TelegramService initialization

# Telegram Bot API - Required for Telegram notifications
TELEGRAM_BOT_TOKEN=1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijk  # Bot token from @BotFather

# Access control
TELEGRAM_ADMIN_CHATS=-1001234567890,-1001234567891  # Admin chat IDs (comma-separated)
TELEGRAM_BLOCKED_CHATS=                              # Blocked chat IDs (comma-separated, empty = none)

# Configuration
TELEGRAM_WEBHOOK_URL=https://api.moonx.farm/telegram/webhook  # Webhook URL (optional)
TELEGRAM_RATE_LIMIT=30                                        # Rate limit (messages per second)

# =============================================================================
# üîí Security Configuration (CORS & Authentication)
# =============================================================================
# Used in server.ts CORS configuration

# CORS settings - Required for web app integration
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://moonx.farm,https://api.moonx.farm  # Allowed origins

# Authentication service integration
AUTH_SERVICE_URL=http://auth-service:3001             # Auth service URL for token verification

# Admin API Key for admin endpoints
ADMIN_API_KEY=your-secure-admin-api-key-here

# =============================================================================
# üìù IMPORTANT NOTES
# =============================================================================
# 
# 1. REQUIRED vs OPTIONAL:
#    - Required: NODE_ENV, PORT, DATABASE_URL (or DB_*), REDIS_URL (or REDIS_*), 
#                KAFKA_BROKERS, SENDGRID_API_KEY, FIREBASE_*, TELEGRAM_BOT_TOKEN
#    - Optional: All other variables have defaults
#
# 2. URL vs INDIVIDUAL:
#    - DATABASE_URL and REDIS_URL are recommended for production
#    - Individual variables can override URL settings if needed
#
# 3. SECURITY:
#    - Never commit actual secrets to version control
#    - Use proper secret management in production
#    - Rotate credentials regularly
#
# 4. PERFORMANCE:
#    - Adjust connection pool sizes based on load testing
#    - Monitor metrics and tune timeout values
#
# 5. WHAT WAS REMOVED:
#    - Worker/cluster configs (not used in current implementation)
#    - Queue size configs (not used, handled by infrastructure)
#    - Performance monitoring configs (not implemented)
#    - Feature flags (not used)
#    - Deployment configs (environment-specific)
#    - SMS configs (not implemented)
#    - Prometheus configs (not used)
#    - Debug flags (use LOG_LEVEL instead)
#
# Total variables: 65 (vs 200+ in old config)
# All variables are ACTUALLY USED in the codebase
# 
# ============================================================================= 