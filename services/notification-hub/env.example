# =============================================================================
# üöÄ MoonX Farm Notification Hub - Environment Variables Example
# =============================================================================
# 
# Copy this file to .env and fill in your actual values
# Only contains variables ACTUALLY USED in the codebase
# 
# =============================================================================

# =============================================================================
# üåç Core Application Configuration
# =============================================================================

# Environment type - Required for infrastructure packages
NODE_ENV=development

# Server configuration - Used in server.ts
PORT=3008                              # Server port number
HOST=0.0.0.0                           # Server host binding

# Logging configuration - Used by @moonx-farm/common logger
LOG_LEVEL=info                         # Log level: debug, info, warn, error
APP_NAME=moonx-notification-hub        # Service name for logs
LOG_ENABLE_CONSOLE=true                # Enable console logging
LOG_ENABLE_FILE=false                  # Enable file logging (optional)
LOG_DIR=logs                           # Log directory (if file logging enabled)
LOG_MAX_FILES=5                        # Max log files to keep
LOG_MAX_SIZE=10m                       # Max log file size
LOG_FORMAT=console                     # Log format: json or console

# =============================================================================
# üìä Database Configuration (PostgreSQL)
# =============================================================================
# Used by @moonx-farm/infrastructure DatabaseManager
# Supports URL-based config (recommended) or individual variables

# Option 1: Database URL (recommended for production)
DATABASE_URL=postgresql://postgres:password@localhost:5432/moonx_notifications

# Option 2: Individual variables (can override URL settings)
DB_HOST=localhost                      # Database host
DB_PORT=5432                           # Database port
DB_NAME=moonx_notifications            # Database name
DB_USER=postgres                       # Database username
DB_PASSWORD=password                   # Database password

# Connection settings
DB_SSL=false                           # Enable SSL connection
DB_MAX_CONNECTIONS=10                  # Max pool connections
DB_MIN_CONNECTIONS=2                   # Min pool connections
DB_IDLE_TIMEOUT=30000                  # Idle timeout (ms)
DB_CONNECTION_TIMEOUT=10000            # Connection timeout (ms)
DB_STATEMENT_TIMEOUT=60000             # Statement timeout (ms)
DB_QUERY_TIMEOUT=30000                 # Query timeout (ms)

# Reliability
DB_MAX_RETRIES=3                       # Max retry attempts
DB_RETRY_DELAY=1000                    # Retry delay (ms)
DB_APPLICATION_NAME=moonx-notification-hub-dev  # App name in DB

# Monitoring
DB_ENABLE_METRICS=true                 # Enable DB metrics
DB_ENABLE_QUERY_LOGGING=true           # Enable query logging (debug only)

# =============================================================================
# üî¥ Redis Configuration (Caching & Queue)
# =============================================================================
# Used by @moonx-farm/infrastructure RedisManager
# Supports URL-based config (recommended) or individual variables

# Option 1: Redis URL (recommended for production)
REDIS_URL=redis://localhost:6379/0

# Option 2: Individual variables (can override URL settings)
REDIS_HOST=localhost                   # Redis host
REDIS_PORT=6379                        # Redis port
REDIS_PASSWORD=                        # Redis password (empty for dev)
REDIS_DB=0                             # Redis database number

# Connection settings
REDIS_KEY_PREFIX=moonx:hub:dev:        # Key prefix for namespace
REDIS_FAMILY=4                         # IP family (4 or 6)
REDIS_CONNECT_TIMEOUT=10000            # Connection timeout (ms)
REDIS_COMMAND_TIMEOUT=5000             # Command timeout (ms)
REDIS_MAX_RETRIES=3                    # Max retry attempts
REDIS_RETRY_DELAY=100                  # Retry delay (ms)

# Features
REDIS_LAZY_CONNECT=true                # Lazy connection (recommended)
REDIS_ENABLE_METRICS=true              # Enable Redis metrics
REDIS_ENABLE_OFFLINE_QUEUE=true        # Enable offline queue

# =============================================================================
# üì® Kafka Configuration (Event Streaming)
# =============================================================================
# Used by @moonx-farm/infrastructure KafkaManager

# Connection - Required
KAFKA_BROKERS=localhost:9092           # Kafka broker list
KAFKA_CLIENT_ID=notification-hub-dev   # Client identifier

# Authentication (optional)
KAFKA_SSL=false                        # Enable SSL
KAFKA_USERNAME=                        # SASL username (if using auth)
KAFKA_PASSWORD=                        # SASL password (if using auth)
KAFKA_SASL_MECHANISM=plain             # SASL mechanism

# Connection settings
KAFKA_CONNECTION_TIMEOUT=10000         # Connection timeout (ms)
KAFKA_REQUEST_TIMEOUT=30000            # Request timeout (ms)
KAFKA_MAX_CONNECTIONS=5                # Max connections
KAFKA_IDLE_TIMEOUT=300000              # Idle timeout (ms)

# Performance
KAFKA_COMPRESSION=gzip                 # Compression: gzip, snappy, lz4, zstd
KAFKA_LOG_LEVEL=info                   # Kafka log level
KAFKA_ENABLE_METRICS=true              # Enable Kafka metrics
KAFKA_TRANSACTION_TIMEOUT=30000        # Transaction timeout (ms)

# Retry configuration
KAFKA_RETRY_INITIAL_TIME=100           # Initial retry delay (ms)
KAFKA_RETRY_COUNT=8                    # Max retry attempts

# Schema Registry (optional)
KAFKA_SCHEMA_REGISTRY_URL=             # Schema registry URL
KAFKA_SCHEMA_REGISTRY_USERNAME=        # Schema registry username
KAFKA_SCHEMA_REGISTRY_PASSWORD=        # Schema registry password

# =============================================================================
# üìß Email Configuration (SendGrid)
# =============================================================================
# Used in server.ts EmailService initialization

# SendGrid API - Required for email notifications
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here    # SendGrid API key
SENDGRID_FROM_EMAIL=noreply@moonx.farm             # From email address
SENDGRID_FROM_NAME=MoonX Farm                      # From name

# SMTP Fallback (optional backup)
SMTP_HOST=smtp.gmail.com               # SMTP server host
SMTP_PORT=587                          # SMTP server port
SMTP_SECURE=false                      # Enable SMTP TLS
SMTP_USER=your_email@gmail.com         # SMTP username
SMTP_PASSWORD=your_app_password        # SMTP password

# Email defaults
EMAIL_FROM=MoonXFarm Dev <dev@moonx.farm>  # Default from address

# =============================================================================
# üì± Push Notification Configuration (Firebase FCM)
# =============================================================================
# Used in server.ts PushNotificationService initialization

# Firebase Service Account - Required for push notifications
FIREBASE_PROJECT_ID=your-firebase-project-id                     # Firebase project ID
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----"  # Firebase private key
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xyz@your-project.iam.gserviceaccount.com  # Firebase client email

# =============================================================================
# ü§ñ Telegram Bot Configuration (grammy framework)
# =============================================================================
# Used in deliveryService.ts TelegramService initialization

# Telegram Bot API - Required for Telegram notifications
TELEGRAM_BOT_TOKEN=1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijk  # Bot token from @BotFather

# Access control
TELEGRAM_ADMIN_CHATS=-1001234567890,-1001234567891  # Admin chat IDs (comma-separated)
TELEGRAM_BLOCKED_CHATS=                              # Blocked chat IDs (comma-separated, empty = none)

# Configuration
TELEGRAM_WEBHOOK_URL=                                # Webhook URL (optional)
TELEGRAM_RATE_LIMIT=30                               # Rate limit (messages per second)

# =============================================================================
# üîí Security Configuration (CORS & Authentication)
# =============================================================================
# Used in server.ts CORS configuration

# CORS settings - Required for web app integration
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://moonx.farm,https://api.moonx.farm

# Authentication service integration
AUTH_SERVICE_URL=http://localhost:3001                 # Auth service URL for token verification

# Admin API Key for admin endpoints (generate a secure random key)
ADMIN_API_KEY=your-secure-admin-api-key-here

# =============================================================================
# üìù DEVELOPMENT SETUP GUIDE
# =============================================================================
# 
# 1. REQUIRED SETUP:
#    - Install PostgreSQL and create database 'moonx_notifications'
#    - Install Redis server
#    - Install Kafka (or use Docker)
#    - Get SendGrid API key from https://sendgrid.com/
#    - Setup Firebase project and get service account key
#    - Create Telegram bot with @BotFather
#
# 2. OPTIONAL SETUP:
#    - Schema Registry for Kafka (for advanced features)
#    - SMTP credentials for email fallback
#    - Multiple admin chats for Telegram
#
# 3. QUICK START:
#    - Copy this file to .env
#    - Update DATABASE_URL, REDIS_URL, KAFKA_BROKERS
#    - Add your SendGrid API key
#    - Add your Firebase credentials
#    - Add your Telegram bot token
#    - Run: npm run dev
#
# 4. WHAT'S MINIMAL:
#    - For basic development: Database, Redis, Kafka, SendGrid
#    - For testing: Add Firebase and Telegram credentials
#    - For production: All variables with proper values
#
# 5. DEBUGGING:
#    - Set LOG_LEVEL=debug for detailed logs
#    - Enable DB_ENABLE_QUERY_LOGGING=true for SQL debugging
#    - Use LOG_FORMAT=console for readable development logs
#
# ============================================================================= 